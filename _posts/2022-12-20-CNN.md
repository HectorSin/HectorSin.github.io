---
layout: posts
title: "신경망부흥의시작CNN"
categories: ML
tag: [python, ML, Concept]
toc: true
---

<참고> https://www.youtube.com/watch?v=YRhxdVk_sIs
<참고> course.fast.ai/lessons/lesson4.html

***

# 합성곱 신경망 CNN(Convolutional Neural Network)

***

## 1. 시각 정보 처리와 합성곱의 필요성

***

### 합성곱 신경망(Convolutional Neural Network-CNN)

- 이미지 분석 정확도를 획기적으로 개선하며 신경망 분야의 새로운 도약을 이끔
- 합성곱은 동물이 시각 정보가 들어올 경우 시각 피질에 있는 뉴런들이 시야의 일부 **범위 안에 있는 영역에 대해 활성화되어 정보를 받아들인다**는 실험의 결과로 알게된 방식을 이미지 인식에 적용한것
- 시각 수용장의 역할을 **합성곱** 혹은 **컨볼루션(Convolution)**이라는 연산이 수행해 결과가 신경세포로 전달
- 다른 알고리즘에 비해 **입력에 대한 전처리가 거의 필요 없음**
- CNN은 입력 틍징 추출하는 방법도 함께 학습되므로 관련 지식을 바탕으로 **특징 추출해 내는 과정(Feature Engineering)**이 필요하지 않으며 이것이 주 장점
- 기존 신경망은 이미지가 가진 기하적 관계를 유지하지 못해 유의미한 데이터를 얻지 못했다.
- 이미지 처리 분야에서 특정한 영역 내에 있는 모든 **픽셀**정보로 하나의 값을 생성하는 일을 합성곱이라고 함
- 합성곱은 특정한 영역을 하나의 특징으로 변환하는 역할을 하며 합성곱과 함께 현재는 **풀링(Pooling)**이라고 부르는 **서브샘플링 계층**을 도입.

## 2. 합성곱의 기본 개념 이해

***

- 이미지를 조작할 때 사용하는 방법 중에 커널(Kernel) 혹은 **필터(Filter)**라고 불리는 작은 행렬을 사용하여 새로운 값을 얻는 방법이 있음
- 필터와 원본 이미지의 대응되는 값들을 서로 곱한 뒤에 모두 더하여 새로운 이미지의 픽셀값 p를 구하는 것, 이러한 연산을 합성곱 연산, 혹은 컨볼루션이라 함
- **평균 필터** & **상자 필터**
  > 특정 픽셀 주변의 픽셀 들이 가진 값의 평균을 취하는 필터
- **가우스 필터**
  > 필터 영역의 모든 픽셀에 동일 한 중요성을 부여하는 것이 아닌 중심 픽엘에는 더 높은 중요도를 부여하고, 중심에서 멀어질 수록 중요성을 낮게함
  >
  > - 여기서 중요도를 **가중치(Weight)**라고 부르고 가우스 함수를 통해 그 값을 결정
  > - 가우스 함수는 종 모양 함수 혹은 정규 분포 함수 모양을 띔

## 3. 합성곱을 통한 특징 추출

***

- 윤곽선을 찾는 것은 색이 연속적이지 않고 갑작스럽게 변하는 픽셀들을 찾아내는 것
- 픽셀의 위치를 **정의역** / 픽셀의 색상을 **치역**으로 하는 함수
  > 픽셀의 각 지점마다 색상 값이 변하는 방향으로 기울기를 구할 수 있음
- 기울기를 구하는 **델 연산자** / 값이 크게 변하는 곳인 기울기 벡터의 크기가 커지는 지점 감지를 위해 사용하는 **라플라시안(Laplacian)**연산 적용
- 두번 이상 미분할 수 있는 함수 f가 있을 때 라플라시안 연산 사용
  > 기울기 연산으로 얻은 값을 자기 자신과 **내적**하는 연산으로 기울기 벡터의 크기를 의미로 변화가 큰 **윤곽선 지점**에서 큰 값
- 합성곱 연산을 할 때 필터로 사용되는 행렬만 바꾸면 여러 가지 다른 결과를 얻을 수 있음
  > 원본 이미지에서 필터의 크기와 동일한 크기를 가진 부분 영역에 대해 해당 필터가 원하는 특징을 얻어내는 것
- 이것을 설계 안하고 기계가 스스로 좋은 필터를 만들어낸다면? -> 필터의 가중치를 모델의 파라미터로 만드는 일
  > 합성곱 신경망의 기본 아이디어

## 4. 합성곱 수행 신경망의 기본 구조와 문제

***

- 하나의 필터만으로는 이미지의 특징을 다양하게 추출할 수 없음
- 특성맵
  > 하나의 이미지에 n개의 필터를 가진 모델의 파라미터로 두고 학습을 진행하여 n장의 특징 추출 결과를 얻는 것
  > 이미지를 처리하고 얻는 결과는 이미지
  > 이 이미지에 대해 다시 합성곱을 수행하는 계층을 계속해서 이어나갈 수 있지만 이때 **문제가 발생**
- **문제**
  > 합성곱을 적용하면 이미지가 작아진다
  > 합성곱을 거치며 작아진 이미지가 이미지 전체의 특성을 요약한 것이 아님
  > 이미지의 가장자리 정보들이 소실되고 중심부의 정보만 살아남는 것이기에 정보를 추상화 시키는 과정도 아님
  > 정보를 요약하지 않으면 입력 단계의 작은 잡음이 가진 영향력도 계층을 거치며 사라지지 않고 계속 전파
- **결론**
  > 합성곱에 의해 이미지가 작아지는 것이 아니고, **정보를 요약하는 계층을 통해 이미지를 적절한 크기로 줄이는 과정이 필요**
  > 이러한 일을 **풀링(Pooling)**이라는 기법을 통해 이루어짐

## 5. 패딩, 스트라이딩, 다중 채널

***

## 6. 강건한 모델을 만드는 풀링

***

## 7. 합성곱 신경망 모델의 구성

***

## 8. 합성곱 신경망 모델의 성공

***

## 9. 전이학습 - 이미 훈련된 모델을 고쳐 쓰기

***
